<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Music and Focus Study</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>

    <div id="mobile-overlay" style="display:none; position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.95); z-index:9999; color:white; text-align:center; padding:50px; box-sizing:border-box;">
        <div style="margin-top:100px; max-width: 500px; margin-left: auto; margin-right: auto;">
            <h2>Mobile Device Detected</h2>
            <p>For the highest data accuracy in this focus study, a desktop browser is recommended. Screen size can impact your Schulte Grid results.</p>
            <button onclick="closeWarning()" style="background:#1DB954; color:white; border:none; padding:15px 30px; font-size:1.1rem; border-radius:8px; cursor:pointer; margin-top:20px; font-weight:bold;">PROCEED ANYWAY</button>
        </div>
    </div>

    <h1>Music & Focus Study</h1>
    
    <div class="study-intro">
        <p><strong>Step 1:</strong> Choose a music genre.<br>
           <strong>Step 2:</strong> Complete the Schulte Grid sequentially (1 to 49).<br>
           <strong>Step 3:</strong> Please feel free to log your results to be used in our study using the Google Form below!</p>
        
        <p>
            Thank you for participating in our study! We are examining how different musical genres impact cognitive focus. 
            You will complete the Schulte Table 5-6 times with various genres playing. 
            Your results will be documented for analysis and all data is strictly anonymized.
        </p>

        <div class="pre-study-note">
            <p><strong>Note:</strong> If you haven't yet already completed our pre-study survey, please consider filling it out for us!</p>
            <a href="https://forms.gle/nxiiKmn8cCppgc4t5" target="_blank" class="survey-btn">Open Pre-Study Survey ↗</a>
        </div>
    </div>

    <div class="section-divider"></div>

    <div class="genre-nav">
        <button onclick="showGenre('pop', this)">Pop</button>
        <button onclick="showGenre('country', this)">Country</button>
        <button onclick="showGenre('edm', this)">EDM</button>
        <button onclick="showGenre('classical', this)">Classical</button>
        <button onclick="togglePreferred(this)">Preferred ▾</button>
    </div>

    <div id="preferred-menu" class="sub-nav">
        <button onclick="showGenre('pref-1', this)">Hip-Hop</button>
        <button onclick="showGenre('pref-2', this)">R&B</button>
        <button onclick="showGenre('pref-3', this)">Indie</button>
        <button onclick="showGenre('pref-4', this)">Rock</button>
    </div>

    <div id="music-section">
        <div id="pop" class="genre-player" style="display: none;">
            <h3>Now Playing: Pop</h3>
            <iframe style="border-radius:12px" src="https://open.spotify.com/embed/track/2plbrEY59IikOBgBGLjaoe?utm_source=generator" frameBorder="0" allow="autoplay; clipboard-write; encrypted-media; fullscreen; picture-in-picture" loading="lazy"></iframe>
        </div>

        <div id="country" class="genre-player" style="display: none;">
            <h3>Now Playing: Country</h3>
            <iframe style="border-radius:12px" src="https://open.spotify.com/embed/track/65DbTqJKhbwqYbZ1Okr0rc?utm_source=generator" frameBorder="0" allow="autoplay; clipboard-write; encrypted-media; fullscreen; picture-in-picture" loading="lazy"></iframe>
        </div>

        <div id="edm" class="genre-player" style="display: none;">
            <h3>Now Playing: EDM</h3>
            <iframe style="border-radius:12px" src="https://open.spotify.com/embed/track/7MmG8p0F9N3C4AXdK6o6Eb?utm_source=generator" frameBorder="0" allow="autoplay; clipboard-write; encrypted-media; fullscreen; picture-in-picture" loading="lazy"></iframe>
        </div>

        <div id="classical" class="genre-player" style="display: none;">
            <h3>Now Playing: Classical</h3>
            <iframe style="border-radius:12px" src="https://open.spotify.com/embed/track/1BncfTJAWxrsxyT9culBrj?utm_source=generator" frameBorder="0" allow="autoplay; clipboard-write; encrypted-media; fullscreen; picture-in-picture" loading="lazy"></iframe>
        </div>

        <div id="pref-1" class="genre-player" style="display: none;">
            <h3>Now Playing: Hip-Hop</h3>
            <iframe style="border-radius:12px" src="https://open.spotify.com/embed/track/39QBkWKnap8wRSW4WB9OK0?utm_source=generator" frameBorder="0" allow="autoplay; clipboard-write; encrypted-media; fullscreen; picture-in-picture" loading="lazy"></iframe>
        </div>

        <div id="pref-2" class="genre-player" style="display: none;">
            <h3>Now Playing: R&B</h3>
            <iframe style="border-radius:12px" src="https://open.spotify.com/embed/track/4iZ4pt7kvcaH6Yo8UoZ4s2?utm_source=generator" frameBorder="0" allow="autoplay; clipboard-write; encrypted-media; fullscreen; picture-in-picture" loading="lazy"></iframe>
        </div>

        <div id="pref-3" class="genre-player" style="display: none;">
            <h3>Now Playing: Indie</h3>
            <iframe style="border-radius:12px" src="https://open.spotify.com/embed/track/5XeFesFbtLpXzIVDNQP22n?utm_source=generator" frameBorder="0" allow="autoplay; clipboard-write; encrypted-media; fullscreen; picture-in-picture" loading="lazy"></iframe>
        </div>

        <div id="pref-4" class="genre-player" style="display: none;">
            <h3>Now Playing: Rock</h3>
            <iframe style="border-radius:12px" src="https://open.spotify.com/embed/track/60a0Rd6pjrkxjPbaKzXjfq?utm_source=generator" frameBorder="0" allow="autoplay; clipboard-write; encrypted-media; fullscreen; picture-in-picture" loading="lazy"></iframe>
        </div>
    </div>

    <div class="section-divider"></div>

    <!--This is the Schulte Table-->
    <div class="task-container">
        <h3 style="color: #1d2a46; text-transform: uppercase; letter-spacing: 1px;">Concentration Task</h3>
        <iframe 
            src="https://drafterleo.github.io/schulte/" 
            class="schulte-iframe"
            title="Schulte Grid Test">
        </iframe>
        <p>This Schulte Table was sourced from drafterleo's public github page.</p>
    </div>

    <div class="section-divider"></div>

    <div class="results-container">
        <h3>Log Your Results</h3>
        <p style="font-size: 0.9rem; color: #666; margin-bottom: 15px;">
            After completing each grid, please enter the genre and your time below.
        </p>
        <iframe src="https://docs.google.com/forms/d/e/1FAIpQLSfY_V0E5JyNMjg87G_AjoIVG_GVFiNid4pv35eQivEW1fCPqg/viewform?embedded=true" 
        class="form-iframe" frameborder="0" marginheight="0" marginwidth="0">Loading…</iframe>
    </div>

    <script>
        function resetButtons() {
            const buttons = document.getElementsByTagName('button');
            for (let i = 0; i < buttons.length; i++) {
                buttons[i].classList.remove('active-btn');
            }
        }

        function showGenre(genreId, btnElement) {
            // Hide all players first
            const players = document.getElementsByClassName('genre-player');
            for (let i = 0; i < players.length; i++) {
                players[i].style.display = 'none';
            }

            // Handle submenu visibility
            if (!genreId.startsWith('pref')) {
                document.getElementById('preferred-menu').style.display = 'none';
            }

            resetButtons();
            
            // Show the specific selected player
            const targetPlayer = document.getElementById(genreId);
            if(targetPlayer) {
                targetPlayer.style.display = 'block';
            }
            btnElement.classList.add('active-btn');
        }

        function togglePreferred(btnElement) {
            const menu = document.getElementById('preferred-menu');
            
            // Hide all music players to clear space
            const players = document.getElementsByClassName('genre-player');
            for (let i = 0; i < players.length; i++) {
                players[i].style.display = 'none';
            }

            if (menu.style.display === 'flex') {
                menu.style.display = 'none';
                btnElement.classList.remove('active-btn');
            } else {
                menu.style.display = 'flex';
                resetButtons();
                btnElement.classList.add('active-btn');
            }
        }

        window.onload = function() {
            if (window.innerWidth <= 768) {
                document.getElementById('mobile-overlay').style.display = 'block';
            }
        };

        function closeWarning() {
            document.getElementById('mobile-overlay').style.display = 'none';
        }
    </script>
</body>
</html>